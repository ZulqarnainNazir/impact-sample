doctype html
html lang="en"
  head
    title = content_for :title
    meta charset="utf-8"
    meta http-equiv="X-UA-Compatible" content="IE=edge"
    meta name="viewport" content="width=device-width, initial-scale=1"
    - if @page.try(:settings).try(:no_index)
      meta name="robots" content="noindex, nofollow"
    - if content_for?(:description)
      meta name="description" content=content_for(:description)
    meta property="og:title" content=content_for(:title)
    meta property="og:type" content="website"
    - if content_for?(:description)
      meta property="og:description" content=content_for(:description)
    - if content_for?(:image)
      meta property="og:image" content=content_for(:image)
    - if content_for?(:image_width)
      meta property="og:image:width" content=content_for(:image_width)
    - if content_for?(:image_height)
      meta property="og:image:height" content=content_for(:image_height)
    - if content_for?(:canonical_url)
      meta property="og:url" content=content_for(:canonical_url)
    = csrf_meta_tags
    link rel="icon" href="/favicon.png"
    - if content_for?(:canonical_url)
      link rel="canonical" href=content_for(:canonical_url)
    = stylesheet_link_tag 'application', media: 'all', protocol: :https, data: { turbolinks_track: true }
    = javascript_include_tag 'application', protocol: :https, data: { turbolinks_track: true }
    - cache @website do
      = @website.head_injection.try(:html_safe)
    - cache @page do
      = @page.try(:page_head_injection).try(:html_safe)
    css:
      @import url('https://fonts.googleapis.com/css?family=#{@website.h1_font_family}');
      @import url('https://fonts.googleapis.com/css?family=#{@website.h2_font_family}');
      @import url('https://fonts.googleapis.com/css?family=#{@website.h3_font_family}');
      @import url('https://fonts.googleapis.com/css?family=#{@website.h4_font_family}');
      @import url('https://fonts.googleapis.com/css?family=#{@website.h5_font_family}');
      @import url('https://fonts.googleapis.com/css?family=#{@website.h6_font_family}');
      @import url('https://fonts.googleapis.com/css?family=#{@website.paragraph_font_family}');
      @import url('https://fonts.googleapis.com/css?family=#{@website.blockquote_font_family}');
      @import url('https://fonts.googleapis.com/css?family=#{@website.lead_font_family}');
      body {
        background-color: #{@website.background_color};
        color: #{@website.foreground_color};
      }
      .webpage-block .jumbotron h1, h1 {
        color: #{@website.h1_font_color};
        font-family: #{@website.h1_font_family};
        font-size: #{@website.h1_font_desk_size_value}px;
      }
      .webpage-block .jumbotron h2, h2 {
        color: #{@website.h2_font_color};
        font-family: #{@website.h2_font_family};
        font-size: #{@website.h2_font_desk_size_value}px;
      }
      .webpage-block .jumbotron h3, h3 {
        color: #{@website.h3_font_color};
        font-family: #{@website.h3_font_family};
        font-size: #{@website.h3_font_desk_size_value}px;
      }
      .webpage-block .jumbotron h4, h4 {
        color: #{@website.h4_font_color};
        font-family: #{@website.h4_font_family};
        font-size: #{@website.h4_font_desk_size_value}px;
      }
      .webpage-block .jumbotron h5, h5 {
        color: #{@website.h5_font_color};
        font-family: #{@website.h5_font_family};
        font-size: #{@website.h5_font_desk_size_value}px;
      }
      .webpage-block .jumbotron h6, h6 {
        color: #{@website.h6_font_color};
        font-family: #{@website.h6_font_family};
        font-size: #{@website.h6_font_desk_size_value}px;
      }
      .webpage-block .jumbotron p, p, .webpage-block div, .panel div, li {
        color: #{@website.paragraph_font_color};
        font-family: #{@website.paragraph_font_family};
        font-size: #{@website.paragraph_font_desk_size_value}px;
      }
      .jumbotron blockquote, blockquote {
        color: #{@website.blockquote_font_color};
        font-family: #{@website.blockquote_font_family};
        font-size: #{@website.blockquote_font_desk_size_value}px;
      }
      .jumbotron .lead, .lead {
        color: #{@website.lead_font_color};
        font-family: #{@website.lead_font_family};
        font-size: #{@website.lead_font_desk_size_value}px;
      }
      @media (max-width: 767px) {
        .webpage-block .jumbotron h1, h1 {
          font-size: #{@website.h1_font_mobile_size_value}px;
        }
        .webpage-block .jumbotron h2, h2 {
          font-size: #{@website.h2_font_mobile_size_value}px;
        }
        .webpage-block .jumbotron h3, h3 {
          font-size: #{@website.h3_font_mobile_size_value}px;
        }
        .webpage-block .jumbotron h4, h4 {
          font-size: #{@website.h4_font_mobile_size_value}px;
        }
        .webpage-block .jumbotron h5, h5 {
          font-size: #{@website.h5_font_mobile_size_value}px;
        }
        .webpage-block .jumbotron h6, h6 {
          font-size: #{@website.h6_font_mobile_size_value}px;
        }
        .webpage-block .jumbotron p, p {
          font-size: #{@website.paragraph_font_mobile_size_value}px;
        }
        .webpage-block .jumbotron blockquote, blockquote {
          font-size: #{@website.blockquote_font_mobile_size_value}px;
        }
        .webpage-block .jumbotron .lead, .lead {
          font-size: #{@website.lead_font_mobile_size_value}px;
        }
      }
      .webpage-background a {
        color: #{@website.link_color};
      }
      .webpage-block a {
        color: #{@website.link_color};
      }
      .webpage-contact a {
        color: #{@website.link_color};
      }
      .webpage-about a {
        color: #{@website.link_color};
      }
      .webpage-footer {
        background-color: #{@website.footer_block.settings['background_color']} !important;
        color: #{@website.footer_block.settings['foreground_color']} !important;
      }
      .webpage-footer a{
        color: #{@website.footer_block.settings['link_color']} !important;
      }
      .webpage-footer .site-footer-simple {
        background-color: #{@website.footer_block.settings['background_color']} !important;
        color: #{@website.footer_block.settings['foreground_color']} !important;
      }
      .webpage-footer .site-footer-simple a,
      .webpage-footer .site-footer-simple a:hover {
        background-color: #{@website.footer_block.settings['background_color']} !important;
        color: #{@website.footer_block.settings['link_color']} !important;
      }
      .webpage-header .navbar {
        background-color: #{@website.header_block.try(:background_color)};
        color: #{@website.header_block.try(:foreground_color)};
      }
      .webpage-header .navbar a,
      .webpage-header .navbar a:hover {
        color: #{@website.header_block.try(:link_color)} !important;
      }
      .webpage-header.navbar-fixed-top {
        background-color: #{@website.background_color};
      }
      .webpage-group .webpage-hero > div > div {
        padding-top: 20px;
      }
      .webpage-header.navbar-fixed-top.hero-behind.transparent {
        background-color: transparent;
      }
      .webpage-header.hero-behind.transparent .navbar {
        background-color: transparent;
      }
      body.hero-behind .webpage-group .webpage-hero > div {
        margin-top: 0 !important;
      }
      .webpage-footer .site-footer-columns .site-footer-upper,
      .webpage-footer .site-footer-layers {
        background-color: #{@website.footer_block.settings['background_color']} !important;
        color: #{@website.footer_block.settings['foreground_color']} !important;
      }
      .webpage-footer .site-footer-columns .site-footer-upper a,
      .webpage-footer .site-footer-columns .site-footer-upper a:hover,
      .webpage-footer .site-footer-layers a,
      .webpage-footer .site-footer-layers a:hover {
        color: #{@website.footer_block.settings['link_color']} !important;
      }
      #{@website.custom_css.try :html_safe}
    - if ENV['GOOGLE_ANALYTICS'].present?
      javascript:
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        #{{"ga('create', '#{@website.google_analytics_id}', 'auto');" if @website.google_analytics_id.present?}}
        ga('create', '#{ENV['GOOGLE_ANALYTICS']}', 'auto', {'name': 'rollup'});

  - hero_position = "hero-below"
  - if !@page.nil?
    - @page.groups.each do |group|
      - if !group.attributes.nil? && group.attributes['type'] == 'HeroGroup' && !group.attributes['settings'].nil? && !group.attributes['settings']['hero_position'].nil?
         - hero_position = 'hero-' + group.attributes['settings']['hero_position']

  body[class="#{hero_position}", data-no-turbolink="true"]
    - if has_header_embed(@website, @page)
      .webpage-header-embed
        == @website.header_embed
    - if @website.header_block
      - unless @page && @page.respond_to?(:hide_navigation) && @page.hide_navigation == '1'
        .webpage-header[class="#{hero_position}"]
          = render @website.header_block
    = yield
    - if has_footer_embed(@website, @page)
      .webpage-footer-embed
        == @website.footer_embed
    - if @website.footer_block
      - unless @page && @page.respond_to?(:hide_navigation) && @page.hide_navigation == '1'
        .webpage-footer
          = render @website.footer_block
          .text-center.locable-footer style="margin: 1em 0"
            = link_to 'https://www.locable.com', target: :_blank do
              = image_tag 'Locable_Dark_Logo.png', protocol: :https, alt: 'Locable&#39;s Marketing Platform for Local Businesses'
            = @website.footer_injection.try(:html_safe)
    = yield :javascript
    = intercom_tag
